#### Ammar Meslmani - CBS-01

#### a.meslmani@innopolis.university

#### the repo link to check the output of this assignment: [full report](https://github.com/spaghetti-cod3r/advanced_linux/tree/main/lab2)

# Lab 2:

- let's unzip the file, check its type, and try to run it:
- ![img](assets/image1.png)
- there is an issue because `libssl1.1` is missing
- let's solve the issue
- ![img](assets/image2.png)
- all the dependencies are resolved now
- ![img](assets/image3.png)
- now let's try to run the program again:
- ![img](assets/image4.png)
- let's analyze the program using `Ghidra`:
- ![img](assets/image5.png)
- now let's create a python keygen:

  ```
  import hashlib

  def generate_key(hwid):
      md5 = hashlib.md5(hwid.encode()).digest()

      # reverse md5
      reversed_md5 = md5[::-1]

      return reversed_md5.hex()

  def main():
      hwid = input("enter hwid: ").strip()

      license_key = generate_key(hwid)
      print(f"\nyour license is: {license_key}")

  if __name__ == "__main__":
      main()
  ```
- let's run the keygen and get the license:
- ![img](assets/image6.png)
- let's check the license generated by the keygen:
- ![img](assets/image10.png)
- now let's patch the following instruction so that `iVar1 = 0` to enforce setting `local_34[4]` to 1
- ![img](assets/image7.png)
- let's use `XOR EAX, EAX` which is  fast operation which guarantees that `EAX` will be set to 0 because of the nature of `XOR` operation
- ![img](assets/image8.png)
- now let's export and run the new patched program:
- ![img](assets/image9.png)
- done!
